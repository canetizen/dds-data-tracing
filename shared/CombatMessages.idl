// Combat Management System DDS Message Types
// OpenTelemetry Trace Context embedded in headers

module combat {

    // Trace Context - W3C Trace Context standard
    struct TraceContext {
        string trace_id;        // 32 hex characters (128-bit)
        string span_id;         // 16 hex characters (64-bit)
        string parent_span_id;  // Parent span ID
        octet trace_flags;      // Sampling flag (01 = sampled)
    };

    // Mission Order from Command Center
    struct MissionOrder {
        // Trace header
        TraceContext trace_ctx;

        // Message metadata
        string source_service;
        int64 timestamp_ns;
        int32 sequence_num;

        // Payload
        string mission_id;
        string mission_type;     // RECON, STRIKE, SUPPLY, EVAC
        string priority;         // LOW, MEDIUM, HIGH, CRITICAL
        string target_zone;      // Alpha, Bravo, Charlie, Delta
        float target_lat;
        float target_lon;
        string commander_id;
    };

    // Reconnaissance Report
    struct ReconReport {
        // Trace header
        TraceContext trace_ctx;

        // Message metadata
        string source_service;
        int64 timestamp_ns;

        // Payload
        string mission_id;
        string report_id;
        string unit_id;
        boolean target_confirmed;
        int32 enemy_count;
        string threat_level;     // NONE, LOW, MEDIUM, HIGH, EXTREME
        string terrain_type;     // URBAN, FOREST, DESERT, MOUNTAIN
        string intel_details;    // JSON format intel data
    };

    // Supply Request/Update
    struct SupplyUpdate {
        // Trace header
        TraceContext trace_ctx;

        // Message metadata
        string source_service;
        int64 timestamp_ns;

        // Payload
        string mission_id;
        string supply_type;      // AMMO, FUEL, MEDICAL, FOOD
        string action;           // DISPATCH, DELIVERED, REQUESTED
        string depot_location;   // DEPOT_A, DEPOT_B, DEPOT_C
        int32 quantity;
        int32 current_stock;
        boolean low_stock_alert;
    };

    // Combat Alert
    struct CombatAlert {
        // Trace header
        TraceContext trace_ctx;

        // Message metadata
        string source_service;
        int64 timestamp_ns;

        // Payload
        string alert_id;
        string alert_type;       // ENEMY_SPOTTED, MISSION_FAILED, CASUALTIES, AIR_RAID
        string severity;         // WARNING, CRITICAL, EMERGENCY
        string affected_zone;
        string message;
        string details;          // JSON format details
    };

    // ============ Track Fusion System ============

    // Source Track - Raw sensor tracks from individual sensors
    struct SourceTrack {
        // Trace header
        TraceContext trace_ctx;

        // Message metadata
        string sensor_id;        // "RADAR-1", "ESM-2", "OPTIK-3"
        string sensor_type;      // RADAR, ESM, OPTIK
        int64 timestamp_ns;

        // Track data
        string source_track_id;  // Unique track ID from sensor
        float position_lat;
        float position_lon;
        float altitude_m;
        float heading_deg;
        float speed_mps;
        float confidence;        // 0.0 - 1.0 detection confidence
        string classification;   // UNKNOWN, FRIEND, HOSTILE, NEUTRAL
    };

    // Tactical Track - Fused track from multiple sensors
    struct TacticalTrack {
        // Trace header
        TraceContext trace_ctx;

        // Message metadata
        string fusion_service_id;
        int64 timestamp_ns;

        // Fused track data
        string tactical_track_id;   // Fused track ID (e.g., "TT-001")
        float position_lat;
        float position_lon;
        float altitude_m;
        float heading_deg;
        float speed_mps;
        float confidence;           // Combined confidence
        string classification;      // Best classification from sources

        // Fusion metadata - which sources contributed
        int32 num_sources;
        string contributing_sensors;    // Comma-separated: "RADAR-1,ESM-2,OPTIK-3"
        string contributing_track_ids;  // Comma-separated source track IDs
    };
};
